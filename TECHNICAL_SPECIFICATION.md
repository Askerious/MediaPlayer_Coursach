# Техническое задание: Музыкальный плеер
**Студент:** Михайлов Константин Викторович
**Группа:** 2407сб2

---
## 1. Описание проекта
### 1.1 Название системы 
Система управления медиатекой
### 1.2 Назначение 
Система предназначена для организации медиатеки. Позволяет воспроизводить аудиофайлы, пополнять медиатеку, создавать плейлисты, 

---
## 2. Функциональные требования
### 2.1 Основные функции системы
#### Функция 1: Проигрывание аудиофайлов
- **Описание:** Пользователь выбирает аудиофайл из списка. Система воспроизводит аудио из выбранного аудиовыход
- **Входные данные:** Пользователь кликает по файлу из списка
- **Результат:** Воспроизведение аудиофайла
#### Функция 2: Импорт аудиофайлов в медиатеку
- **Описание:** Пользователь через диалоговое окно выбирает файл/папку с аудиофайлами. Система проходит по всем вложенным папкам и добавляет все найденные файлы в общую медиатеку
- **Входные данные:** Путь до папки/файла
- **Результат:** Все найденные файлы добавлены в общую медиатеку
#### Функция 3: Импорт альбома в медиатеку
- **Описание:** Пользователь через диалоговое окно выбирает папку (Строго без вложенных папок) с аудиофайлами. Система проходит по папке и добавляет все найденные файлы в новый плейлист
- **Входные данные:** Путь до папки/файла
- **Результат:** Все найденные файлы добавлены в общую медиатеку
#### Функция 4: Управление плейлистами
- **Описание:** Пользователь может добавить/удалить плейлист. В плейлист либо добавлять треки из медиатеки, либо удалять из него треки
- **Входные данные:** Название нового плейлиста в случае создания, состав из выбранных треков из общей медиатеки плейлиста. В случае удаление выбранный плейлист/трек в плейлисте
- **Результат:** Результаты создания, редактирования или удаления сохранены в БД
#### Функция 5: Добавление в избранное
- **Описание:** Пользователь может добавить любой трек в изначально созданный плейлист "Избранное" по одной кнопке.
- **Входные данные:** Пользователь нажимает на кнопку выбранного трека
- **Результат:** Трек добавлен в плейлист
#### Функция 6: Просмотр плейлистов
- **Описание:** Пользователь может просмотреть все созданные плейлисты
- **Входные данные:** Пользователь нажимает на кнопку "Плейлисты"
- **Результат:** Главное окно заменяется на окно с плейлистами
#### Функция 6: Оплата
- **Описание:** Пользователь может оплатить подписку по выбранному тарифу, введя данные банковской карты. Система проверяет корректность данных, создает запись о платеже и, при успешной оплате, автоматически продлевает срок подписки
- **Входные данные:** Тариф, данные карты
- **Результат:** Платеж обработан, подписка продлена, создана запись в БД

---
## 3. Структура базы данных
### Таблица 1: Track
**Описание:** Хранит информацию о треке
**Поля:**
- `Id` (int, PK)
- `UserId` (int, FK -> `User.Id`)
- `Title` (string)
- `Duration` (int)
- `isFavorite` (bool) 
- `FilePath` (string)
**Связи:**
- Один-ко-многим с таблицей PlaylistTracks 
- FK `UserId` -> `User.Id`

### Таблица 2: Playlist
**Поля:**
- `Id` (int, PK)
- `UserId` (int, FK -> `User.Id`)
- `Name` (string)
**Связи:**
- Один-ко-многим с таблицей PlaylistTracks
- FK `UserId` -> `User.Id`

### Таблица 3: PlaylistTrack
**Поля:**
- `PlaylistId` (PK, int, FK -> `Playlist.Id`) 
- `TrackId` (PK, int, FK -> `Track.Id`)
**Связи:**
- FK `PlaylistId` -> `Playlist.Id`
- FK `TrackId` -> `Track.Id`

### Таблица 4: User
**Поля:**
- `Id` (int, PK)
- `Username` (string)
- `PasswordHash` (string)
**Связи:**
- Один-ко-многим с таблицей Payment
- Один-ко-многим с таблицей Track
- Один-ко-многим с таблицей Playlist

### Таблица 5: Payment
**Поля:**
- `Id` (int, PK)
- `UserId` (int, FK -> `User.Id`)
- `Tarrif` (string)
- `CreatedAt`(DateTime)
**Связи:**
- FK `UserId` -> `User.Id`

--- 
## 4. Основные формы приложения
#### Форма 1: MainWindow

**Назначение:** Главная форма приложения для управления медиатекой

**Элементы управления:**
- ToolBar `Menu` — Кнопки: `Импорт`, `Импорт Альбома`, `Плейлисты`
- DataGrid `Tracks` — Колонки: `Название`, `Продолжительность`,  `Избранное` (CheckBox)
- UserControl - Плеер (Пауза, следующий/предыдущий трек, ползунок, громкость)
	- Имеет кнопку пауза/продолжить
	- Ползунок дает возможность перемещаться по треку
	- Ползунок "Громкость" позволяет менять громкость
	- Кнопки "следующий/предыдущий" позволяют проигрывать треки сзади/спереди из очереди

**Действия:**
- Двойной клик по треку — Проигрывание трека
- ContextMenu — Добавить в плейлист/Удалить из медиатеки
- Кнопка "Импорт" — Открывает `ImportWindow`
- Кнопка "Импорт Альбома" — Открывает `ImportAlbumWindow`
- Кнопка "Плейлисты" — Открывает `PlaylistsWindow`

#### Форма 2: ImportWindow
**Назначение:** Импорт файла/папки рекурсивно в медиатеку

**Элементы управления:**
- TextBox `Path` — Путь до файла/папки
- Button `BrowseButton` — Обзор файлов
- Button `ImportButton` — Импорт

**Действия:**
- Кнопка "Импорт" — Запускает функцию импорта
- Кнопка "Обзор" —  Выбор файла/папки

#### Форма 3: ImportAlbumWindow
**Назначение:** Импорт папки в медиатеку как плейлист

**Элементы управления:**
- TextBox `PathToFile` — Путь до папки
- TextBox `PlaylistName` — Имя плейлиста
- Button `BrowseButton` — Обзор файлов 
- Button `ImportButton` — Импорт

**Действия:**
- Кнопка "Импорт" — Импортирует файлы
- Кнопка "Обзор" — Запускает диалоговое окно с выбором файла/папки

#### Форма 4: PlaylistsWindow
**Назначение:** Просмотр и управление плейлистами

**Элементы управления:**
- ListBox `PlaylistsList` — Список плейлистов
- DataGrid `PlaylistTrackGrid` — Список треков в плейлисте
- Button `CreatePlaylist` — Создание нового плейлиста
- Button `DeletePlaylist` — Удаление плейлиста
- Button `ChangePlaylist` — Редактирование плейлиста
- Button `AddToPlaylist` — Добавление трека из медиатеки в плейлист

**Действия:**
- Кнопка "Создать" — Перенаправляет на форму  `CreatePlaylistWindow`
- Кнопка "Удалить" —  Удаляет плейлист из списка
- Кнопка "Изменить" — Перенаправляет на форму `ChangePlaylistWindow`

#### Форма 5: ChangePlaylistWindow
**Назначение:** Редактирование плейлиста

**Элементы управления:**
- TextBox `PlayListName` — Название
- DataGrid `TracksGrid` — Треки
- Button `ChangeButton` — Подтверждение изменений
- Button `CancelButton` — Отмена

**Действия:**
- Кнопка "Изменить" — Сохранение изменений плейлист
- Кнопка "Отмена" —  Закрывает окно без изменений

#### Форма 6: CreatePlaylistWindow
**Назначение:** Создание плейлиста

**Элементы управления:**
- TextBox `PlayListName` — Название
- DataGrid `TracksGrid` — Треки
- Button `ChangeButton` — Подтверждение
- Button `CancelButton` — Отмена

**Действия:**
- Кнопка "Изменить" — Создание плейлиста с выбранным названием и треками
- Кнопка "Отмена" —  Закрывает окно

#### Форма 7: PaymentWindow
**Назначение:** Оплата тарифа

**Элементы управления:**
- ComboBox (тариф) — выбор тарифа подписки/товара
- TextBox (номер карты) — ввод номера банковской карты
- TextBox (срок действия) — ввод срока действия карты (MM/YY)
- TextBox (CVV) — ввод кода безопасности
- TextBlock (сумма) — отображение суммы к оплате
- Button `PayButton` — Оплатить
- Button `CancelButton` — Отмена

**Действия:**
- Кнопка "Оплатить" — Обработка платежа
- Кнопка "Отмена" —  Отмена операции

#### Форма 8: UserLoginWindow
**Назначение:** Вход пользователя

**Элементы управления:**
- TextBox — Имя пользователя
- TextBox — Пароль

**Действия:**
- Кнопка "Вход" — Обработка логина
- Кнопка "Регистрация" — 
---
## 5. Схема переходов между формами![[scheme_of_db.png]]